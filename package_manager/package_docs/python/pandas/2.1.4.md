# Python pandas v2.1.4 -- Approved Documentation

**Package:** pandas
**Version:** 2.1.4 (approved)
**Language:** Python
**PyPI:** https://pypi.org/project/pandas/
**Validation Status:** Approved (2025-12-15)

---

## Overview

pandas is the primary data manipulation library for the orchestrator's Python components (comparison module, data profiling, spec processing). Used for reading/writing Parquet and CSV files, and for column-by-column dataset comparison.

## Installation (Enterprise)

```bash
pip install pandas==2.1.4 --index-url https://internal-pypi.company.com/simple
```

## Key Functions for SDTM Orchestrator

### `pd.read_csv(filepath, ...)`
Read CSV data files.

```python
import pandas as pd

# Read raw clinical data
raw_dm = pd.read_csv('study_data/raw_dm.csv', encoding='utf-8')

# With explicit dtypes (recommended for clinical data)
raw_dm = pd.read_csv('study_data/raw_dm.csv',
    dtype={'SUBJID': str, 'SITEID': str, 'SEX': str},
    encoding='utf-8')
```

**RESTRICTION:** Always specify `encoding='utf-8'`.

### `pd.read_parquet(path, engine='pyarrow')`
Read SDTM output datasets for comparison.

```python
# Read production and QC datasets
prod = pd.read_parquet('orchestrator/outputs/datasets/dm.parquet', engine='pyarrow')
qc = pd.read_parquet('orchestrator/outputs/qc/dm_qc.parquet', engine='pyarrow')
```

**RESTRICTION:** Use `engine='pyarrow'` explicitly.

### `DataFrame.compare(other)`
Compare two DataFrames column by column.

```python
# Compare production vs QC
diff = prod.compare(qc)
if diff.empty:
    print("MATCH: 0 differences")
else:
    print(f"MISMATCH: {len(diff)} rows differ")
```

### `DataFrame.to_parquet(path, engine='pyarrow')`
Write orchestrator outputs.

```python
df.to_parquet('output.parquet', engine='pyarrow', index=False)
```

**RESTRICTION:** Do NOT use `inplace=True` on any pandas operations -- always assign results.

## Version-Specific Notes (2.1.4)

- pandas 2.x changed default dtype inference -- use `dtype` parameter explicitly for clinical data
- The `engine='pyarrow'` parameter requires pyarrow >= 14.0.0 (also approved)
- `DataFrame.compare()` was added in pandas 1.1.0 -- available in approved version
